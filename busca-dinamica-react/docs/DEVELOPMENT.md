# üõ†Ô∏è Guia de Desenvolvimento

> **Guia completo para desenvolvedores que querem contribuir com o Busca Din√¢mica 2.0**

## üìã **√çndice**

1. [Configura√ß√£o do Ambiente](#configura√ß√£o-do-ambiente)
2. [Estrutura do Projeto](#estrutura-do-projeto)
3. [Padr√µes de C√≥digo](#padr√µes-de-c√≥digo)
4. [Fluxo de Desenvolvimento](#fluxo-de-desenvolvimento)
5. [Testes](#testes)
6. [Debugging](#debugging)
7. [Performance](#performance)
8. [Seguran√ßa](#seguran√ßa)
9. [Deploy](#deploy)

## üöÄ **Configura√ß√£o do Ambiente**

### **Pr√©-requisitos**

```bash
# Node.js 18+
node --version  # v18.0.0 ou superior

# npm ou yarn
npm --version   # 8.0.0 ou superior

# Git
git --version   # 2.30.0 ou superior
```

### **Instala√ß√£o Inicial**

```bash
# Clone o reposit√≥rio
git clone https://github.com/clenio77/busca-dinamica.git
cd busca-dinamica/busca-dinamica-react

# Instale depend√™ncias
npm install

# Configure vari√°veis de ambiente
cp env.example .env

# Inicie o servidor de desenvolvimento
npm start
```

### **Ferramentas Recomendadas**

- **VS Code** com extens√µes:
  - ESLint
  - Prettier
  - Auto Rename Tag
  - Bracket Pair Colorizer
  - GitLens
  - Thunder Client (para testar APIs)

- **Navegadores**:
  - Chrome DevTools
  - Firefox Developer Tools
  - React Developer Tools

## üèóÔ∏è **Estrutura do Projeto**

```
busca-dinamica-react/
‚îú‚îÄ‚îÄ üìÅ src/                          # C√≥digo fonte React
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ components/               # Componentes React
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ __tests__/           # Testes dos componentes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SearchBar.js            # Barra de busca principal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.js              # Menu lateral
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AddressList.js          # Lista de endere√ßos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ThemeToggle.js           # Alternador de tema
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ OptimizedImage.js        # Imagem otimizada
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ VoiceSearchButton.js    # Bot√£o de busca por voz
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AdvancedActions.js      # A√ß√µes avan√ßadas
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PWAInstallPrompt.js     # Prompt de instala√ß√£o PWA
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ hooks/                   # Custom hooks
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ __tests__/           # Testes dos hooks
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAddressSearch.js     # Hook de busca
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useTheme.js             # Hook de tema
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAnalytics.js         # Hook de analytics
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usePerformance.js       # Hook de performance
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useVoiceSearch.js       # Hook de busca por voz
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useSearchHistory.js     # Hook de hist√≥rico
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useSavedFilters.js      # Hook de filtros salvos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useSEO.js               # Hook de SEO
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useSecurity.js          # Hook de seguran√ßa
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ utils/                   # Utilit√°rios
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ filterAddresses.js      # Filtros de endere√ßos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exportUtils.js          # Utilit√°rios de exporta√ß√£o
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sitemapGenerator.js      # Gerador de sitemap
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ config/                  # Configura√ß√µes
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analytics.js            # Configura√ß√£o de analytics
‚îÇ   ‚îú‚îÄ‚îÄ App.js                      # Componente principal
‚îÇ   ‚îú‚îÄ‚îÄ App.css                     # Estilos principais
‚îÇ   ‚îî‚îÄ‚îÄ index.js                    # Ponto de entrada
‚îú‚îÄ‚îÄ üìÅ routes/                      # APIs Express
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ __tests__/               # Testes das APIs
‚îÇ   ‚îú‚îÄ‚îÄ cep.js                      # Endpoints de CEP
‚îÇ   ‚îú‚îÄ‚îÄ admin.js                    # Endpoints administrativos
‚îÇ   ‚îú‚îÄ‚îÄ health.js                   # Health checks
‚îÇ   ‚îî‚îÄ‚îÄ monitoring.js               # Endpoints de monitoramento
‚îú‚îÄ‚îÄ üìÅ middleware/                  # Middlewares
‚îÇ   ‚îú‚îÄ‚îÄ csp.js                      # Content Security Policy
‚îÇ   ‚îú‚îÄ‚îÄ sanitization.js             # Sanitiza√ß√£o de entrada
‚îÇ   ‚îî‚îÄ‚îÄ rateLimit.js                # Rate limiting
‚îú‚îÄ‚îÄ üìÅ utils/                       # Utilit√°rios do servidor
‚îÇ   ‚îú‚îÄ‚îÄ advancedLogger.js            # Sistema de logs
‚îÇ   ‚îú‚îÄ‚îÄ metrics.js                   # Coleta de m√©tricas
‚îÇ   ‚îî‚îÄ‚îÄ alerts.js                    # Sistema de alertas
‚îú‚îÄ‚îÄ üìÅ database/                    # Configura√ß√£o de banco
‚îÇ   ‚îú‚îÄ‚îÄ init.js                     # Inicializa√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ connection.js               # Conex√£o SQLite
‚îÇ   ‚îî‚îÄ‚îÄ postgres-init.js            # Inicializa√ß√£o PostgreSQL
‚îú‚îÄ‚îÄ üìÅ e2e/                         # Testes E2E
‚îÇ   ‚îú‚îÄ‚îÄ search.spec.js              # Testes de busca
‚îÇ   ‚îú‚îÄ‚îÄ global-setup.js             # Setup global
‚îÇ   ‚îî‚îÄ‚îÄ global-teardown.js          # Teardown global
‚îú‚îÄ‚îÄ üìÅ artillery/                   # Testes de performance
‚îÇ   ‚îî‚îÄ‚îÄ performance.yml             # Configura√ß√£o Artillery
‚îú‚îÄ‚îÄ üìÅ docs/                        # Documenta√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ api-swagger.yaml            # Documenta√ß√£o da API
‚îÇ   ‚îú‚îÄ‚îÄ DEVELOPMENT.md              # Este guia
‚îÇ   ‚îî‚îÄ‚îÄ DEPLOYMENT.md               # Guia de deploy
‚îú‚îÄ‚îÄ üìÅ public/                      # Arquivos p√∫blicos
‚îÇ   ‚îú‚îÄ‚îÄ manifest.json               # Manifest PWA
‚îÇ   ‚îú‚îÄ‚îÄ sw.js                       # Service Worker
‚îÇ   ‚îú‚îÄ‚îÄ robots.txt                  # Robots.txt
‚îÇ   ‚îî‚îÄ‚îÄ sitemap.xml                 # Sitemap
‚îú‚îÄ‚îÄ server.js                       # Servidor Express
‚îú‚îÄ‚îÄ package.json                    # Depend√™ncias e scripts
‚îú‚îÄ‚îÄ jest.config.js                  # Configura√ß√£o Jest
‚îú‚îÄ‚îÄ playwright.config.js             # Configura√ß√£o Playwright
‚îî‚îÄ‚îÄ README.md                       # Documenta√ß√£o principal
```

## üìù **Padr√µes de C√≥digo**

### **JavaScript/React**

```javascript
// ‚úÖ Bom - Componente funcional com hooks
import React, { useState, useEffect } from 'react';
import PropTypes from 'prop-types';

const SearchBar = ({ onSearch, placeholder }) => {
  const [query, setQuery] = useState('');
  const [isLoading, setIsLoading] = useState(false);

  useEffect(() => {
    // L√≥gica do useEffect
  }, [query]);

  const handleSubmit = (e) => {
    e.preventDefault();
    if (query.trim()) {
      setIsLoading(true);
      onSearch(query.trim());
    }
  };

  return (
    <form onSubmit={handleSubmit} className="search-form">
      <input
        type="text"
        value={query}
        onChange={(e) => setQuery(e.target.value)}
        placeholder={placeholder}
        className="search-input"
        disabled={isLoading}
      />
      <button type="submit" disabled={isLoading}>
        {isLoading ? 'Buscando...' : 'Buscar'}
      </button>
    </form>
  );
};

SearchBar.propTypes = {
  onSearch: PropTypes.func.isRequired,
  placeholder: PropTypes.string
};

SearchBar.defaultProps = {
  placeholder: 'Digite para buscar...'
};

export default SearchBar;
```

### **CSS/Styling**

```css
/* ‚úÖ Bom - Usando CSS variables para temas */
:root {
  --primary-color: #3b82f6;
  --secondary-color: #64748b;
  --background-color: #ffffff;
  --text-color: #1f2937;
  --border-color: #e5e7eb;
}

[data-theme="dark"] {
  --primary-color: #60a5fa;
  --secondary-color: #94a3b8;
  --background-color: #1f2937;
  --text-color: #f9fafb;
  --border-color: #374151;
}

.search-form {
  display: flex;
  gap: 0.5rem;
  padding: 1rem;
  background-color: var(--background-color);
  border: 1px solid var(--border-color);
  border-radius: 0.5rem;
}

.search-input {
  flex: 1;
  padding: 0.75rem;
  border: 1px solid var(--border-color);
  border-radius: 0.375rem;
  background-color: var(--background-color);
  color: var(--text-color);
}

.search-input:focus {
  outline: none;
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}
```

### **API Endpoints**

```javascript
// ‚úÖ Bom - Endpoint com valida√ß√£o e tratamento de erro
const express = require('express');
const { body, validationResult } = require('express-validator');

router.get('/api/cep/search', [
  query('q')
    .isLength({ min: 2, max: 100 })
    .withMessage('Termo de busca deve ter entre 2 e 100 caracteres')
    .trim()
    .escape(),
  query('cidade')
    .optional()
    .isLength({ max: 50 })
    .withMessage('Nome da cidade muito longo')
    .trim()
    .escape(),
  query('estado')
    .optional()
    .matches(/^[A-Z]{2}$/)
    .withMessage('Estado deve ser uma sigla de 2 letras')
], async (req, res) => {
  try {
    // Verificar erros de valida√ß√£o
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
      return res.status(400).json({
        success: false,
        message: 'Erro de valida√ß√£o',
        errors: errors.array()
      });
    }

    const { q, cidade, estado, limit = 50, offset = 0 } = req.query;

    // Buscar endere√ßos
    const addresses = await searchAddresses(q, { cidade, estado, limit, offset });

    res.json({
      success: true,
      data: addresses,
      total: addresses.length,
      query: q
    });

  } catch (error) {
    logger.error('Erro na busca de endere√ßos:', error);
    res.status(500).json({
      success: false,
      message: 'Erro interno do servidor'
    });
  }
});
```

## üîÑ **Fluxo de Desenvolvimento**

### **1. Prepara√ß√£o**

```bash
# Atualize sua branch
git checkout master
git pull origin master

# Crie uma nova branch
git checkout -b feature/nova-funcionalidade
```

### **2. Desenvolvimento**

```bash
# Inicie o servidor de desenvolvimento
npm start

# Em outro terminal, execute linting em watch mode
npm run lint:watch

# Execute testes em watch mode
npm run test:watch
```

### **3. Testes**

```bash
# Execute todos os testes
npm run test:all

# Verifique cobertura
npm run test:coverage

# Execute testes E2E
npm run test:e2e

# Execute testes de performance
npm run test:performance
```

### **4. Commit e Push**

```bash
# Adicione arquivos
git add .

# Commit com mensagem descritiva
git commit -m "feat: adicionar busca por voz

- Implementar reconhecimento de voz
- Adicionar bot√£o de microfone
- Integrar com Web Speech API
- Adicionar testes unit√°rios
- Atualizar documenta√ß√£o"

# Push para o reposit√≥rio
git push origin feature/nova-funcionalidade
```

### **5. Pull Request**

1. Crie um Pull Request no GitHub
2. Preencha o template de PR
3. Adicione screenshots se necess√°rio
4. Aguarde review e CI/CD

## üß™ **Testes**

### **Testes Unit√°rios**

```javascript
// ‚úÖ Bom - Teste completo de componente
import { render, screen, fireEvent, waitFor } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import SearchBar from '../SearchBar';

describe('SearchBar', () => {
  const mockOnSearch = jest.fn();

  beforeEach(() => {
    mockOnSearch.mockClear();
  });

  it('deve renderizar corretamente', () => {
    render(<SearchBar onSearch={mockOnSearch} />);
    
    expect(screen.getByPlaceholderText('Digite para buscar...')).toBeInTheDocument();
    expect(screen.getByRole('button')).toBeInTheDocument();
  });

  it('deve chamar onSearch quando formul√°rio for submetido', async () => {
    render(<SearchBar onSearch={mockOnSearch} />);
    
    const input = screen.getByPlaceholderText('Digite para buscar...');
    const button = screen.getByRole('button');
    
    await userEvent.type(input, 'avenida paulista');
    fireEvent.click(button);
    
    expect(mockOnSearch).toHaveBeenCalledWith('avenida paulista');
  });

  it('n√£o deve chamar onSearch com query vazia', () => {
    render(<SearchBar onSearch={mockOnSearch} />);
    
    const button = screen.getByRole('button');
    fireEvent.click(button);
    
    expect(mockOnSearch).not.toHaveBeenCalled();
  });
});
```

### **Testes de Integra√ß√£o**

```javascript
// ‚úÖ Bom - Teste de API
const request = require('supertest');
const app = require('../server');

describe('CEP API', () => {
  describe('GET /api/cep/search', () => {
    it('deve retornar endere√ßos para busca v√°lida', async () => {
      const response = await request(app)
        .get('/api/cep/search')
        .query({ q: 'rua' })
        .expect(200);

      expect(response.body).toHaveProperty('success', true);
      expect(response.body).toHaveProperty('data');
      expect(Array.isArray(response.body.data)).toBe(true);
    });

    it('deve retornar erro para busca muito curta', async () => {
      const response = await request(app)
        .get('/api/cep/search')
        .query({ q: 'a' })
        .expect(400);

      expect(response.body.success).toBe(false);
      expect(response.body.message).toContain('m√≠nimo');
    });
  });
});
```

### **Testes E2E**

```javascript
// ‚úÖ Bom - Teste E2E com Playwright
const { test, expect } = require('@playwright/test');

test('deve realizar busca e mostrar resultados', async ({ page }) => {
  await page.goto('http://localhost:3000');
  
  // Digitar termo de busca
  await page.fill('input[placeholder*="buscar"]', 'rua');
  
  // Aguardar resultados
  await page.waitForSelector('text=resultados encontrados', { timeout: 10000 });
  
  // Verificar que h√° resultados
  const resultsText = await page.locator('text=resultados encontrados').textContent();
  expect(resultsText).toMatch(/\d+ resultados encontrados/);
});
```

## üêõ **Debugging**

### **Debugging Frontend**

```javascript
// ‚úÖ Bom - Debugging com console estruturado
const debugSearch = (query, filters) => {
  console.group('üîç Busca de Endere√ßos');
  console.log('Query:', query);
  console.log('Filtros:', filters);
  console.log('Timestamp:', new Date().toISOString());
  console.groupEnd();
};

// ‚úÖ Bom - Debugging de performance
const debugPerformance = (operation, startTime) => {
  const duration = performance.now() - startTime;
  console.log(`‚ö° ${operation}: ${duration.toFixed(2)}ms`);
};
```

### **Debugging Backend**

```javascript
// ‚úÖ Bom - Logging estruturado
const logger = require('../utils/advancedLogger');

const searchAddresses = async (query, filters) => {
  logger.info('Iniciando busca de endere√ßos', {
    query,
    filters,
    timestamp: new Date().toISOString()
  });

  try {
    const results = await performSearch(query, filters);
    
    logger.info('Busca conclu√≠da com sucesso', {
      query,
      resultsCount: results.length,
      duration: Date.now() - startTime
    });

    return results;
  } catch (error) {
    logger.error('Erro na busca de endere√ßos', {
      query,
      error: error.message,
      stack: error.stack
    });
    throw error;
  }
};
```

### **Ferramentas de Debug**

```bash
# Debug do React
npm run start:debug

# Debug do servidor
node --inspect server.js

# Debug dos testes
npm run test:debug
```

## ‚ö° **Performance**

### **Otimiza√ß√µes Frontend**

```javascript
// ‚úÖ Bom - Lazy loading de componentes
const LazyAddressList = React.lazy(() => import('./AddressList'));

// ‚úÖ Bom - Memoiza√ß√£o de componentes
const MemoizedSearchBar = React.memo(SearchBar);

// ‚úÖ Bom - Debounce para busca
const useDebounce = (value, delay) => {
  const [debouncedValue, setDebouncedValue] = useState(value);

  useEffect(() => {
    const handler = setTimeout(() => {
      setDebouncedValue(value);
    }, delay);

    return () => {
      clearTimeout(handler);
    };
  }, [value, delay]);

  return debouncedValue;
};
```

### **Otimiza√ß√µes Backend**

```javascript
// ‚úÖ Bom - Cache com Redis
const cacheSearch = async (query, results) => {
  const key = `search:${query}`;
  await redis.setex(key, 3600, JSON.stringify(results)); // 1 hora
};

// ‚úÖ Bom - Pagina√ß√£o eficiente
const getAddressesPaginated = async (query, page = 1, limit = 50) => {
  const offset = (page - 1) * limit;
  
  const [results, total] = await Promise.all([
    db.all(`
      SELECT * FROM addresses 
      WHERE logradouro LIKE ? 
      LIMIT ? OFFSET ?
    `, [`%${query}%`, limit, offset]),
    db.get('SELECT COUNT(*) as total FROM addresses WHERE logradouro LIKE ?', [`%${query}%`])
  ]);

  return {
    data: results,
    total: total.total,
    page,
    totalPages: Math.ceil(total.total / limit)
  };
};
```

## üîí **Seguran√ßa**

### **Valida√ß√£o de Entrada**

```javascript
// ‚úÖ Bom - Sanitiza√ß√£o de entrada
const sanitizeInput = (input) => {
  return DOMPurify.sanitize(input, {
    ALLOWED_TAGS: [],
    ALLOWED_ATTR: []
  });
};

// ‚úÖ Bom - Valida√ß√£o de CEP
const validateCEP = (cep) => {
  const cleanCEP = cep.replace(/\D/g, '');
  return /^\d{8}$/.test(cleanCEP) ? cleanCEP : false;
};
```

### **Rate Limiting**

```javascript
// ‚úÖ Bom - Rate limiting configur√°vel
const rateLimit = require('express-rate-limit');

const searchLimiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutos
  max: 100, // m√°ximo 100 requests por IP
  message: {
    success: false,
    message: 'Muitas requisi√ß√µes. Tente novamente em 15 minutos.'
  },
  standardHeaders: true,
  legacyHeaders: false
});
```

## üöÄ **Deploy**

### **Deploy Local**

```bash
# Build para produ√ß√£o
npm run build

# Teste local da build
npm run dev:render
```

### **Deploy na Nuvem**

```bash
# Render.com
git push origin master  # Deploy autom√°tico

# Vercel
vercel --prod

# Netlify
netlify deploy --prod
```

### **Verifica√ß√£o P√≥s-Deploy**

```bash
# Health check
curl https://seu-app.com/health

# Testes de smoke
npm run test:smoke

# Verificar m√©tricas
curl -u admin:password https://seu-app.com/monitoring/summary
```

## üìö **Recursos Adicionais**

### **Documenta√ß√£o**

- [React Docs](https://react.dev/)
- [Express.js Docs](https://expressjs.com/)
- [Jest Docs](https://jestjs.io/)
- [Playwright Docs](https://playwright.dev/)

### **Ferramentas**

- [ESLint](https://eslint.org/)
- [Prettier](https://prettier.io/)
- [Postman](https://www.postman.com/)
- [Chrome DevTools](https://developers.google.com/web/tools/chrome-devtools)

### **Comunidade**

- [GitHub Issues](https://github.com/clenio77/busca-dinamica/issues)
- [Discord](https://discord.gg/buscadinamica)
- [Stack Overflow](https://stackoverflow.com/questions/tagged/busca-dinamica)

---

**Boa sorte no desenvolvimento! üöÄ**
